---
title: "Cool Thing"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(tidyverse)
library(DT)
library(readr)
library(data.table)
library(zoo)
```


```{r}
beaver2 = beaver2
beaver1 = beaver1

beaverDay1 = beaver2 %>% filter(day == 307)
beaverDay2 = beaver2 %>% filter(day == 308) 
beaverDay2$time = beaverDay2$time + 2400
beaver2 = rbind(beaverDay1, beaverDay2) 

beaver2$rollMean = rollmean(beaver2$temp, 5, fill = NA)

beaver2$beaver = "beaver2"


beaverDay1 = beaver1 %>% filter(day == 346)
beaverDay2 = beaver1 %>% filter(day == 347) 
beaverDay2$time = beaverDay2$time + 2400
beaver1 = rbind(beaverDay1, beaverDay2)

beaver1$rollMean = rollmean(beaver1$temp, 5, fill = NA)

beaver1$beaver = "beaver1"


beavers = rbind(beaver1, beaver2)
beavers = rename(beavers, actual = temp)
```

Column {data-width=50}
-----------------------------------------------------------------------
```{r}
selectInput("variable", label = "Beaver Selection", multiple = F, choices = c("beaver1", "beaver2"), selected = "beaver2")
selectInput("variable1", label = "Rolling Mean Actual", multiple = F, choices = c("rollMean", "actual"), selected = "beaver2")

actionButton("execute", "Download")
```


Column {data-width=650}
-----------------------------------------------------------------------

### Beaver Temp Plot

```{r}

beaverGraph <- reactive ({

  beaver = beavers %>% filter(beaver == input$variable) %>%  
    select(time, input$variable1) %>% 
    rename(graphed_y = input$variable1)
  }) 
# renderPlot({
#   ggplot(beaverGraph()) +
#     geom_point(aes(x = time, y = graphed_y)) + 
#     ylim(36.5, 38.5) +
#     stat_smooth(method = "lm") + 
#     ggtitle("Linear Model Fitted to Beaver Data")
# })

renderPlot({
  data <- beaverGraph()  # Retrieve the data frame
  ggplot(data, aes(x = time, y = graphed_y)) +
    geom_point() + 
    ylim(36.5, 38.5) +
    stat_smooth(method = "lm") + 
    ggtitle("Linear Model Fitted to Beaver Data")
})


# ggplot(data = churn_data, aes(x=Distinct_Called_Numbers, y=Customer_Value)) +
#   geom_point() +
#   stat_smooth(method = "lm", col = "dodgerblue3") +
#   theme(panel.background = element_rect(fill = "white"),
#         axis.line.x=element_line(),
#         axis.line.y=element_line()) +
#   ggtitle("Linear Model Fitted to Data") 

```


Column {data-width=500}
-----------------------------------------------------------------------

### Beaver !!

```{r picture, echo = F, fig.cap = "Title", out.width = '100%'}
 knitr::include_graphics(
  "BEAVER.png"
 )


```
